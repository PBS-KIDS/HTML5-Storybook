/*! HTML5-Storybook 1.0.0 */
!function(){"use strict";var PBS;PBS||(PBS={}),PBS.KIDS||(PBS.KIDS={}),PBS.KIDS.storybook=function(a){"use strict";var b={};return b.log=function(b){a.console&&a.console.log(b)},b.error=function(b){a.console&&a.console.log("ERROR: "+b)},b.debug=function(b){a.console&&a.console.log("DEBUG: "+b)},b.createCanvas=function(b,c){var d=a.document.createElement("canvas");return c.id&&(d.id=c.id),c.className&&(d.className=c.className),c.width&&(d.width=c.width),c.height&&(d.height=c.height),b&&b.appendChild(d),d.getContext("2d")},b.getElementPosition=function(a){var c,d={x:a.offsetLeft,y:a.offsetTop};return a.offsetParent&&(c=b.getElementPosition(a.offsetParent),d.x+=c.x,d.y+=c.y),d},b.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)},b.getNumberFromString=function(a){return void 0!==a?("string"!=typeof a&&(a=a.toString()),a.replace(/[^-\d\.]/g,"")):void 0},b.isInPixelUnits=function(a){return-1!==a.toString().toUpperCase().indexOf("PX")},b.isInPercentageUnits=function(a){return-1!==a.toString().indexOf("%")},b.removeAllChildren=function(a){var b,c=a.childNodes.length;for(b=0;c>b;b+=1)a.removeChild(a.childNodes[a.childNodes.length-1])},b}(window),PBS.KIDS.storybook.eventDispatcher=function(){"use strict";var a={},b={};return a.addEventListener=function(a,c){void 0===b[a]&&(b[a]=[]),b[a].push(c)},a.removeEventListener=function(a,c){var d;if(b[a])for(d=0;d<b[a].length;d+=1)b[a][d]===c&&b[a].splice(d,1)},a.removeAllEventListeners=function(){for(var a in b)b.hasOwnProperty(a)&&delete b[a]},a.dispatchEvent=function(a,c){var d;if(void 0!==b[a])for(d=0;d<b[a].length;d+=1)b[a][d](c)},a},PBS.KIDS.storybook.interactionObject=function(a,b,c){"use strict";return b.KIDS.storybook.makeInteractionObject(a,b,b.KIDS.storybook.view(b,c))},PBS.KIDS.storybook.makeInteractionObject=function(a,b,c){"use strict";var d,e=!1,f=c.getElement(),g=function(a){var g={},h=b.KIDS.storybook.getElementPosition(f),i=a.changedTouches?a.changedTouches[0]:a;g.x=i.clientX-h.x,g.y=i.clientY-h.y,e=!0,d={x:g.x,y:g.y},c.dispatchEvent("PRESS",{x:g.x,y:g.y}),a.preventDefault()},h=function(g){var h={},i=b.KIDS.storybook.getElementPosition(f),j=g.changedTouches?g.changedTouches[0]:g;h.x=j.clientX-i.x,h.y=j.clientY-i.y,e&&c.dispatchEvent("DRAG",{x:h.x,y:h.y,startX:d.x,startY:d.y,distanceX:a.Math.abs(h.x-d.x),distanceY:a.Math.abs(h.y-d.y),distance:b.KIDS.storybook.distance({x:h.x,y:h.y},{x:d.x,y:d.y})})},i=function(a){e=!1,c.dispatchEvent("RELEASE")},j=function(a){e=!1,c.dispatchEvent("CANCEL")};return c.cancelInteraction=function(){j()},f.addEventListener("mousedown",g),f.addEventListener("mousemove",h),f.addEventListener("mouseup",i),f.addEventListener("mouseout",j),f.addEventListener("touchstart",g),f.addEventListener("touchmove",h),f.addEventListener("touchend",i),f.addEventListener("touchcancel",j),c},PBS.KIDS.storybook.resourceLoader=function(a,b){"use strict";var c=b.KIDS.storybook.eventDispatcher(),d={},e=[],f=0,g=!1,h=function(){f+=1,c.dispatchEvent("QUEUE_UPDATE",{progress:f,total:e.length}),f===e.length&&c.dispatchEvent("QUEUE_LOADED")};return c.addToQueue=function(a){return void 0===d[a]&&(d[a]={image:new Image,url:a,loaded:!1},e.push(d[a])),d[a]},c.loadQueue=function(){var a;if(!g){g=!0;for(a in d)d.hasOwnProperty(a)&&d[a].image.addEventListener("load",h);for(a in d)d.hasOwnProperty(a)&&(d[a].image.src=d[a].url)}},c.getProgress=function(){return f},c.getTotal=function(){return e.length},c},PBS.KIDS.storybook.book=function(a,b,c,d){"use strict";var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=b.KIDS.storybook,F=E.eventDispatcher(),G=E.resourceLoader(a,b),H=!1,I=!1,J=!1,K=!1,L=d.book,M=!1,N=[],O=void 0!==d.book.margin?d.book.margin:2,P=!1,Q=!1,R=!1,S=function(){J||(H||f===g&&(-1===f?q.update():(N[i]&&N[i].update(),N[j]&&N[j].update())),a.requestAnimationFrame(S),H||T())},T=function(){-1===f?q.render():(N[i]&&N[i].render(),N[j]&&N[j].render())},U=function(a){a===N[j]||a===q?F.nextPage():"SINGLE-PAGE"===h&&F.nextPage()},V=function(a){a===N[i]?F.previousPage():"SINGLE-PAGE"===h&&F.previousPage()},W=function(){e.removeEventListener("PLAY_COMPLETE",W),N[j].pageSound?(_(),e.play(N[j].pageSound),e.addEventListener("PLAY_COMPLETE",X)):aa()},X=function(){e.removeEventListener("PLAY_COMPLETE",X),aa()},Y=function(){a.document.body.style.height="200%",a.scrollTo(0,1),a.document.body.style.height=a.innerHeight+"px"},Z=function(b){"SINGLE-PAGE"===h&&-1!==f&&(b*=1.8),r=b*(O/100),t.style.width=a.parseInt(b-2*r,10)+"px",u.style.width=a.parseInt(b-2*r,10)+"px",k=w.offsetWidth,l=k/L.pageWidth*L.pageHeight,t.style.margin=r+"px",t.style.height=a.parseInt(l)+"px",u.style.height=a.parseInt(l)+"px",A.style.width=a.parseInt(k,10)+1+"px",A.style.height=a.parseInt(l,10)+"px"},$=function(b){r=b*(O/100),u.style.height=b-2*r+"px",t.style.height=b-2*r+"px",l=w.offsetHeight,k=u.offsetHeight/L.pageHeight*L.pageWidth,-1===f?(u.style.width=a.parseInt(k,10)+"px",t.style.width=a.parseInt(k,10)+"px"):(u.style.width=a.parseInt(2*k,10)+"px",t.style.width=a.parseInt(2*k,10)+"px"),A.style.width=a.parseInt(k,10)+1+"px",A.style.height=l+"px"},_=function(){u.className=u.className.replace(" loud",""),u.className=u.className.replace(" silent",""),u.className+=" loud"},aa=function(){u.className=u.className.replace(" loud",""),u.className=u.className.replace(" silent",""),u.className+=" silent"},ba=function(){var a;Y(),a=c.clientHeight>c.clientWidth?"SINGLE-PAGE":"TWO-PAGE",h!==a&&(F.dispatchEvent("LAYOUT_CHANGE",a),h=a),Z(c.offsetWidth),t.offsetHeight>c.offsetHeight*(1-O/100*2)&&$(c.offsetHeight),c.style.fontSize=k/L.pageWidth+"px",ca()},ca=function(){var a=c.offsetWidth;t.style.marginTop=(c.offsetHeight-t.offsetHeight)/2+"px",-1===f?(t.style.transition="",t.style["-webkit-transition"]="",t.style["-moz-transition"]="",t.style["-ms-transition"]="",t.style["-o-transition"]="",t.style.marginLeft=(a-u.offsetWidth)/2+"px"):"SINGLE-PAGE"===h?(t.style.transition="margin-left "+p/1e3+"s linear",t.style["-webkit-transition"]="margin-left "+p/1e3+"s linear",t.style["-moz-transition"]="margin-left "+p/1e3+"s linear",t.style["-ms-transition"]="margin-left "+p/1e3+"s linear",t.style["-o-transition"]="margin-left "+p/1e3+"s linear",f%2?t.style.marginLeft=-(r+2*k-a)+"px":t.style.marginLeft=r+"px"):(t.className="",t.style.marginLeft=(a-u.offsetWidth)/2+"px")},da=function(){var a=c.offsetWidth;t.style.marginTop=(c.offsetHeight-t.offsetHeight)/2+"px",-1===f?(t.style.transition="",t.style["-webkit-transition"]="",t.style["-moz-transition"]="",t.style["-ms-transition"]="",t.style["-o-transition"]="",t.style.marginLeft=(a-u.offsetWidth)/2+"px"):"SINGLE-PAGE"===h?(t.style.transition="margin-left "+o/1e3+"s linear",t.style["-webkit-transition"]="margin-left "+o/1e3+"s linear",t.style["-moz-transition"]="margin-left "+o/1e3+"s linear",t.style["-ms-transition"]="margin-left "+o/1e3+"s linear",t.style["-o-transition"]="margin-left "+o/1e3+"s linear",g%2?t.style.marginLeft=-(r+2*k-a)+"px":t.style.marginLeft=r+"px"):(t.className="",t.style.marginLeft=(a-u.offsetWidth)/2+"px")},ea=function(){g!==f&&(g>f?(u.style.marginLeft="0",u.style.width="100%",v.style.display="block",w.style.width="50%",E.removeAllChildren(v),v.appendChild(N[i].getElement()),E.removeAllChildren(w),w.appendChild(N[j].getElement())):(E.removeAllChildren(w),-1===g?(u.style.marginLeft="0",u.style.width="50%",v.style.display="none",w.style.width="100%",w.appendChild(q.getElement())):w.appendChild(N[j].getElement()))),E.removeAllChildren(A),A.style.display="none",f=g,ba(),-1===g?(q.navigationToComplete(),q.pageSound&&e.play(q.pageSound)):(N[i].navigationToComplete(),N[j].navigationToComplete(),"SINGLE-PAGE"===h?i===f?N[i].pageSound&&e.play(N[i].pageSound):N[j].pageSound&&e.play(N[j].pageSound):N[i].pageSound?(_(),e.play(N[i].pageSound),e.addEventListener("PLAY_COMPLETE",W)):N[j].pageSound&&(_(),e.play(N[i].pageSound),e.addEventListener("PLAY_COMPLETE",X))),-1===g?(y&&(y.style.display="none"),z&&(z.style.display="block")):"SINGLE-PAGE"===h?(y&&(y.style.display=-1===g?"none":"block"),z&&(z.style.display=g===N.length-1?"none":"block")):(y&&(y.style.display=-1===i?"none":"block"),z&&(z.style.display=j===N.length-1?"none":"block")),F.dispatchEvent("PAGE_CHANGE"),M=!1},fa=function(){var b,c;E.removeAllChildren(A),g>f?(b=a.document.createElement("div"),b.className="pbsPageTurnPageContainer",A.appendChild(b),-1===f?A.style.marginLeft=-k/2+"px":A.style.marginLeft="0",b.appendChild(N[i].getElement()),c=a.document.createElement("div"),c.className="pbsLeftPageTurnGradient",A.appendChild(c),A.style.transformOrigin="right top",A.style.webkitTransformOrigin="right top",A.style.mozTransformOrigin="right top",A.style.msTransformOrigin="right top",A.style.oTransformOrigin="right top"):(b=a.document.createElement("div"),b.className="pbsPageTurnPageContainer",A.appendChild(b),-1===g?(A.style.marginLeft=k+"px",b.appendChild(q.getElement()),q.update(),q.render()):(A.style.marginLeft=k+"px",b.appendChild(N[j].getElement())),c=a.document.createElement("div"),c.className="pbsRightPageTurnGradient",A.appendChild(c),A.style.transformOrigin="left top",A.style.webkitTransformOrigin="left top",A.style.mozTransformOrigin="left top",A.style.msTransformOrigin="left top",A.style.oTransformOrigin="left top"),c.style.opacity=1,c.style.transition="opacity "+o/2/1e3+"s linear",c.style["-webkit-transition"]="opacity "+o/2/1e3+"s linear",c.style["-moz-transition"]="opacity "+o/2/1e3+"s linear",c.style["-ms-transition"]="opacity "+o/2/1e3+"s linear",c.style["-o-transition"]="opacity "+o/2/1e3+"s linear",a.setTimeout(function(){c.style.opacity=0,A.style.transform="scale(1, 1)",A.style["-webkit-transform"]="scale(1, 1)",A.style["-moz-transform"]="scale(1, 1)",A.style["-ms-transform"]="scale(1, 1)",A.style["-o-transform"]="scale(1, 1)"},0),a.setTimeout(ea,o/2)},ga=function(b,c){var d,l,m=i,n=j;M||(E.log("Navigate to page "+(b+1)),(void 0===m||void 0===n||0===o)&&(c=!0),g=b,e&&e.stop(),E.removeAllChildren(A),g%2?(i=g-1,j=g):(i=g,j=g+1),y&&(y.style.display="none"),z&&(z.style.display="none"),g===f?-1===f?w.appendChild(q.getElement()):(E.removeAllChildren(v),v.appendChild(N[i].getElement()),E.removeAllChildren(w),w.appendChild(N[j].getElement())):g>f?(c||(E.removeAllChildren(v),-1!==f&&v.appendChild(N[m].getElement())),E.removeAllChildren(w),w.appendChild(N[j].getElement())):(E.removeAllChildren(v),-1!==g&&v.appendChild(N[i].getElement()),c||(E.removeAllChildren(w),w.appendChild(N[n].getElement()))),N[i]&&N[i].navigationToBegin(),N[j]&&N[j].navigationToBegin(),c?(-1===g?(u.style.width="50%",v.style.display="none",w.style.width="100%"):(v.style.display="block",w.style.display="block",v.style.width="50%",w.style.width="50%"),ea()):g>f?"TWO-PAGE"===h||f%2?(d=a.document.createElement("div"),d.className="pbsPageTurnPageContainer",A.appendChild(d),-1===f?(A.style.marginLeft=k/2+"px",u.style.marginLeft=k/2+"px",u.style.width=k+"px",v.style.display="none",w.style.width=k+"px",d.appendChild(q.getElement()),E.removeAllChildren(v),v.appendChild(N[i].getElement()),E.removeAllChildren(w),w.appendChild(N[j].getElement())):(A.style.marginLeft=k+"px",d.appendChild(N[n].getElement())),l=a.document.createElement("div"),l.className="pbsRightPageTurnGradient",A.appendChild(l),l.style.opacity=0,l.style.transition="opacity "+o/2/1e3+"s linear",l.style["-webkit-transition"]="opacity "+o/2/1e3+"s linear",l.style["-moz-transition"]="opacity "+o/2/1e3+"s linear",l.style["-ms-transition"]="opacity "+o/2/1e3+"s linear",l.style["-o-transition"]="opacity "+o/2/1e3+"s linear",A.style.transformOrigin="left top",A.style.webkitTransformOrigin="left top",A.style.mozTransformOrigin="left top",A.style.msTransformOrigin="left top",A.style.oTransformOrigin="left top",a.setTimeout(function(){A.style.transform="scale(0, 1)",A.style["-webkit-transform"]="scale(0, 1)",A.style["-moz-transform"]="scale(0, 1)",A.style["-ms-transform"]="scale(0, 1)",A.style["-o-transform"]="scale(0, 1)",l.style.opacity=1},0),A.style.display="block",a.setTimeout(da,500),M=!0,a.setTimeout(fa,o/2)):ea():"TWO-PAGE"===h||f%2===0?(d=a.document.createElement("div"),d.className="pbsPageTurnPageContainer",A.appendChild(d),d.appendChild(N[m].getElement()),A.style.marginLeft=0,-1===g&&(u.style.marginLeft=k+"px",u.style.width=k+"px",v.style.display="none",w.style.width=k+"px"),l=a.document.createElement("div"),l.className="pbsLeftPageTurnGradient",A.appendChild(l),l.style.opacity=0,l.style.transition="opacity "+o/2/1e3+"s linear",l.style["-webkit-transition"]="opacity "+o/2/1e3+"s linear",l.style["-moz-transition"]="opacity "+o/2/1e3+"s linear",l.style["-ms-transition"]="opacity "+o/2/1e3+"s linear",l.style["-o-transition"]="opacity "+o/2/1e3+"s linear",A.style.transformOrigin="right top",A.style.webkitTransformOrigin="right top",A.style.mozTransformOrigin="right top",A.style.msTransformOrigin="right top",A.style.oTransformOrigin="right top",a.setTimeout(function(){A.style.transform="scale(0, 1)",A.style["-webkit-transform"]="scale(0, 1)",A.style["-moz-transform"]="scale(0, 1)",A.style["-ms-transform"]="scale(0, 1)",A.style["-o-transform"]="scale(0, 1)",l.style.opacity=1},0),A.style.display="block",a.setTimeout(da,500),M=!0,a.setTimeout(fa,o/2)):ea())},ha=function(){var b;for(b=0;b<N.length;b+=1)q.render(),N[b].render();c.innerHTML="",c.appendChild(s),c.appendChild(x),a.onorientationchange=F.onOrientationChange,a.addEventListener("resize",ba),ba(),f=void 0!==L.startOnPage?L.startOnPage-1:-1,ga(f,!0),ba(),c.addEventListener("touchmove",function(a){a.preventDefault()}),m&&(m.update(),m.render(),m.addEventListener("PRESS",F.previousPage)),n&&(n.update(),n.render(),n.addEventListener("PRESS",F.nextPage)),F.dispatchEvent("STARTED"),S()},ia=function(){var a,b,c,e,f;for(e in L.pageBackground)L.pageBackground.hasOwnProperty(e)&&"url"===e&&(L.pageBackground.resource=G.addToQueue(L.pageBackground.url));for(e in L.oddPageBackground)L.oddPageBackground.hasOwnProperty(e)&&"url"===e&&(L.oddPageBackground.resource=G.addToQueue(L.oddPageBackground.url));for(e in L.evenPageBackground)L.evenPageBackground.hasOwnProperty(e)&&"url"===e&&(L.evenPageBackground.resource=G.addToQueue(L.evenPageBackground.url));for(e in d.cover.background)d.cover.background.hasOwnProperty(e)&&"url"===e&&(d.cover.background.resource=G.addToQueue(d.cover.background.url));for(b=0;b<d.cover.content.length;b+=1)for(e in d.cover.content[b])if("url"===e)d.cover.content[b].resource=G.addToQueue(d.cover.content[b].url);else if("content"===e)for(c=0;c<d.cover.content[b].content.length;c+=1)for(f in d.cover.content[b].content[c])"url"===f&&(d.cover.content[b].content[c].resource=G.addToQueue(d.cover.content[b].content[c].url));for(a=0;a<d.pages.length;a+=1){for(e in d.pages[a].background)d.pages[a].background.hasOwnProperty(e)&&"url"===e&&(d.pages[a].background.resource=G.addToQueue(d.pages[a].background.url));for(b=0;b<d.pages[a].content.length;b+=1){for(e in d.pages[a].content[b])if("url"===e)d.pages[a].content[b].resource=G.addToQueue(d.pages[a].content[b].url);else if("content"===e)for(c=0;c<d.pages[a].content[b].content.length;c+=1)for(f in d.pages[a].content[b].content[c])"url"===f&&(d.pages[a].content[b].content[c].resource=G.addToQueue(d.pages[a].content[b].content[c].url));if("DRAWINGPAD"===d.pages[a].content[b].type.toUpperCase()){d.pages[a].content[b].overlayUrl&&(d.pages[a].content[b].overlayResource=G.addToQueue(d.pages[a].content[b].overlayUrl)),d.pages[a].content[b].textureUrl&&(d.pages[a].content[b].textureResource=G.addToQueue(d.pages[a].content[b].textureUrl));for(e in d.pages[a].content[b])if("colorButtons"===e)for(c=0;c<d.pages[a].content[b].colorButtons.length;c+=1)for(f in d.pages[a].content[b].colorButtons[c])"url"===f&&(d.pages[a].content[b].colorButtons[c].resource=G.addToQueue(d.pages[a].content[b].colorButtons[c].url));else if("clearButtons"===e)for(c=0;c<d.pages[a].content[b].clearButtons.length;c+=1)for(f in d.pages[a].content[b].clearButtons[c])"url"===f&&(d.pages[a].content[b].clearButtons[c].resource=G.addToQueue(d.pages[a].content[b].clearButtons[c].url));else if("eraserButtons"===e)for(c=0;c<d.pages[a].content[b].eraserButtons.length;c+=1)for(f in d.pages[a].content[b].eraserButtons[c])"url"===f&&(d.pages[a].content[b].eraserButtons[c].resource=G.addToQueue(d.pages[a].content[b].eraserButtons[c].url))}}}},ja=function(a){a?D=a:(D={},D.progress=G.getProgress(),D.total=G.getTotal()),e?P?Q?B.innerHTML='<p id="loadingText">Loading '+(D.progress+1)+" of "+D.total+"</p>":B.innerHTML='<p id="loadingText">Loading '+D.progress+" of "+(D.total+1)+"</p>":B.innerHTML='<p id="loadingText">Loading '+D.progress+" of "+(D.total+1)+"<br />Press to load sound.</p>":B.innerHTML='<p id="loadingText">Loading '+D.progress+" of "+D.total+"</p>"},ka=function(){Q||(c.removeEventListener("LOAD_STARTED",ka),Q=!0,R&&ha())},la=function(){R=!0,F.dispatchEvent("LOADED"),e&&Q!==!0||ha()},ma=function(){c.removeEventListener("PRESS",ma),e.addEventListener("LOAD_STARTED",ka),e.load(),P=!0,ja()},na=function(){var c;if(K)E.error("Cannot initialize storybook more than once.");else{for(K=!0,s=a.document.createElement("div"),s.id="pbsBookWrapper",d.background&&d.background.color&&(s.style.backgroundColor=d.background.color),d.background&&d.background.url&&(s.style.backgroundImage="url("+d.background.url+")"),t=a.document.createElement("div"),t.id="pbsBookContainer",s.appendChild(t),u=a.document.createElement("div"),u.className="pbsPagesContainer",t.appendChild(u),v=a.document.createElement("div"),v.className="pbsPageContainer",v.id="pbsLeftPage",v.style.width="50%",u.appendChild(v),w=a.document.createElement("div"),w.className="pbsPageContainer",w.id="pbsRightPage",u.appendChild(w),A=a.document.createElement("div"),A.className="pbsPageTurnContainer",t.appendChild(A),x=a.document.createElement("nav"),x.className="pbsStorybookNav",L.previousPageButton&&(y=a.document.createElement("div"),y.id="pbsPrevPageButton",y.className="pbsPageButton",L.previousPageButton.parentElement=y,L.previousPageButton.resource=G.addToQueue(L.previousPageButton.url),m=E.sprite(a,b,L.previousPageButton),m=E.makeInteractionObject(a,b,m),x.appendChild(y)),L.nextPageButton&&(z=a.document.createElement("div"),z.id="pbsNextPageButton",z.className="pbsPageButton",L.nextPageButton.parentElement=z,L.nextPageButton.resource=G.addToQueue(L.nextPageButton.url),n=E.sprite(a,b,L.nextPageButton),n=E.makeInteractionObject(a,b,n),x.appendChild(z)),ia(),o=L&&void 0!==L.pageTurnDuration?L.pageTurnDuration:1e3,p=L&&void 0!==L.pageSlideDuration?L.pageSlideDuration:250,A.style.transition="transform "+o/2/1e3+"s linear",A.style["-webkit-transition"]="-webkit-transform "+o/2/1e3+"s linear",A.style["-moz-transition"]="-moz-transform "+o/2/1e3+"s linear",A.style["-ms-transition"]="-ms-transform "+o/2/1e3+"s linear",A.style["-o-transition"]="-o-transform "+o/2/1e3+"s linear",d.audio&&d.audio&&d.audio.name&&d.audio.enabled!==!1&&(e=E.audioPlayer(a,b,d.audio.path+d.audio.name)),q=E.page(a,b,d.cover,0,{bookConfig:L,audioPlayer:e}),q.addEventListener("DRAG_LEFT",U),q.addEventListener("DRAG_RIGHT",V),c=0;c<d.pages.length;c+=1)N[c]=E.page(a,b,d.pages[c],c+1,{bookConfig:L,audioPlayer:e}),N[c].update(),N[c].render();for(d.pages.length%2&&(N[d.pages.length]=E.page(a,b,{},d.pages.length+1,{bookConfig:L,audioPlayer:e})),c=0;c<N.length;c+=1)N[c].addEventListener("DRAG_LEFT",U),N[c].addEventListener("DRAG_RIGHT",V);ba()}};return F.pause=function(){H||(H=!0)},F.unpause=function(){H&&(H=!1)},F.onOrientationChange=function(){ba()},F.destroy=function(){var a;if(!J){for(J=!0,c.innerHTML="",a=0;a<N.length;a+=1)N[a].destroy();q.destroy(),F=null}},F.nextPage=function(){var a;a="SINGLE-PAGE"===h?f+1:f%2?f+1:f+2,a<N.length&&ga(a)},F.previousPage=function(){var a;a="SINGLE-PAGE"===h?f-1:f%2?f-2:f-1,a>=-1&&ga(a)},F.gotoPage=function(a){-1>f-1||f+1>N.length||ga(a)},F.load=function(){I||(I=!0,c.innerHTML="",B=a.document.createElement("section"),B.className="loadingContainer",c.appendChild(B),e&&(C=E.interactionObject(a,b,B),C.addEventListener("PRESS",ma)),G.addEventListener("QUEUE_UPDATE",ja),G.addEventListener("QUEUE_LOADED",la),G.loadQueue())},function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;c+=1)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),na(),F},PBS.KIDS.storybook.page=function(a,b,c,d,e){"use strict";var f,g,h,i=b.KIDS.storybook,j=i.eventDispatcher(),k=e.bookConfig.pageWidth||768,l=e.bookConfig.pageHeight||1024,m=e.audioPlayer,n=[],o=[],p=[],q=[],r=[],s=function(){numResourcesLoaded+=1,numResourcesLoaded!==totalResources||loaded||(loaded=!0,j.dispatchEvent("LOAD_COMPLETE"))};return j.pageSound=null,j.init=function(){var t,u,v,w,x,y;if(void 0===c)return void i.error("Configuration missing for page "+d);if(void 0===d)return void i.error("Missing page number parameter");if(g=a.document.createElement("section"),g.id="pbsPage"+d,g.className="pbsPage",h=i.interactionObject(a,b,g),h.addEventListener("DRAG",function(a){a.distanceX>k/20&&(h.cancelInteraction(),a.x>a.startX?j.dispatchEvent("DRAG_RIGHT",j):j.dispatchEvent("DRAG_LEFT",j))}),void 0===c.background&&(c.background={}),c.background.parentElement=g,c.background.className="pbsPageCanvas",c.background.resource||c.background.color||(e.bookConfig.oddPageBackground&&d%2&&e.bookConfig.oddPageBackground.resource?c.background.resource=e.bookConfig.oddPageBackground.resource:e.bookConfig.oddPageBackground&&d%2&&e.bookConfig.oddPageBackground.color?c.background.color=e.bookConfig.oddPageBackground.color:e.bookConfig.evenPageBackground&&d%2===0&&e.bookConfig.evenPageBackground.resource?c.background.resource=e.bookConfig.evenPageBackground.resource:e.bookConfig.evenPageBackground&&d%2===0&&e.bookConfig.evenPageBackground.color?c.background.color=e.bookConfig.evenPageBackground.color:e.bookConfig.pageBackground&&e.bookConfig.pageBackground.resource?c.background.resource=e.bookConfig.pageBackground.resource:e.bookConfig.pageBackground&&e.bookConfig.pageBackground.color&&(c.background.color=e.bookConfig.pageBackground.color)),f=i.sprite(a,b,c.background),f.addEventListener("LOAD_COMPLETE",s),f=i.makeInteractionObject(a,b,f),y=c&&c.sound&&void 0!==c.sound.persist?c.sound.persist:!0,m&&c&&c.sound&&(j.pageSound=i.sound(c.sound.startTime,c.sound.endTime,{loop:c.sound.loop,persist:y})),c&&c.content)for(t=0;t<c.content.length;t+=1)switch(c.content[t].type){case"TextArea":c.content[t].parentElement=g,c.content[t].parentWidth=k,c.content[t].parentHeight=l,c.content[t].className="pbsPage"+d+"TextArea"+(n.length+1),u=i.textArea(a,b,c.content[t]),c.content[t].sound&&(u=i.makeInteractionObject(a,b,u),u=i.makeAudible(a,b,m,u,c.content[t].sound)),n.push(u),r.push(u);break;case"Sprite":c.content[t].parentElement=g,c.content[t].parentWidth=k,c.content[t].parentHeight=l,c.content[t].className="pbsPage"+d+"Sprite"+(o.length+1),v=i.sprite(a,b,c.content[t]),v=i.makeInteractionObject(a,b,v),c.content[t].sound&&(v=i.makeAudible(a,b,m,v,c.content[t].sound)),o.push(v),r.push(v),c.content[t].playAfterDelay>0&&(v.playAfterDelay=c.content[t].playAfterDelay);break;case"Cycler":c.content[t].parentElement=g,c.content[t].parentWidth=k,c.content[t].parentHeight=l,c.content[t].className="pbsPage"+d+"Cycler"+(p.length+1),w=i.cycler(a,b,c.content[t]),c.content[t].sound&&(w=i.makeAudible(a,b,m,w,c.content[t].sound)),r.push(w),p.push(w),c.content[t].playAfterDelay>0&&(w.playAfterDelay=c.content[t].playAfterDelay);break;case"DrawingPad":c.content[t].parentElement=g,c.content[t].parentWidth=k,c.content[t].parentHeight=l,c.content[t].className="pbsPage"+d+"DrawingPad"+(p.length+1),x=i.drawingPad(a,b,c.content[t]),x=i.makeInteractionObject(a,b,x),c.content[t].sound&&(x=i.makeAudible(a,b,m,x,c.content[t].sound)),q.push(x),r.push(x);break;default:i.error("Object Type Unknown: "+c.content[t].type)}},j.getElement=function(){return g},j.navigationToBegin=function(){var a;for(a=0;a<p.length;a+=1)p[a].reset()},j.navigationToComplete=function(){var b;for(f&&f.play(),b=0;b<o.length;b+=1)o[b].autoStart===!0?o[b].play():o[b].reset(),o[b].playAfterDelay>0&&a.setTimeout(o[b].play,1e3*a.parseInt(o[b].playAfterDelay,10));for(b=0;b<p.length;b+=1)p[b].autoStart===!0?p[b].play():p[b].reset(),p[b].playAfterDelay>0&&a.setTimeout(p[b].play,1e3*a.parseInt(p[b].playAfterDelay,10))},j.destroy=function(){var a;for(f&&f.destroy(),a=0;a<r.length;a+=1)r[a].destroy();j=null},j.update=function(){var a;for(f&&f.update(),a=0;a<r.length;a+=1)r[a].update()},j.render=function(){var a;for(f&&f.render(),a=0;a<r.length;a+=1)r[a].render()},j.quiet=function(){g.className=g.className.replace(" loud",""),g.className=g.className.replace(" quiet",""),g.className+=" quiet"},j.loud=function(){g.className=g.className.replace(" loud",""),g.className=g.className.replace(" quiet",""),g.className+=" loud"},j.init(),j},PBS.KIDS.storybook.textArea=function(a,b,c){"use strict";var d,e,f,g=!1,h=c&&c.parentElement,i=[],j=[],k=function(a,b,c,d){var e,f,g;return f="<"+b,d&&(f+="(.*?)"),f+=">(.*?)</"+b+">",e=new RegExp(f,"gi"),g=d?"["+c+"$1]$2[/"+c+"]":"["+c+"]$1[/"+c+"]",a.replace(e,g)},l=function(b){var c;return c=a.document.createElement("div"),c.innerHTML=b,c.textContent||c.innerText||""},m=function(){var b;if(!g){for(g=!0,d.initView(),e.className="pbsTextArea",c.className&&(e.className+=" "+c.className),e.style.textAlign=void 0!==c.align?c.align:"center",e.style.fontFamily=void 0!==c.font?c.font:"",e.style.fontSize=void 0!==c.size?c.size+"em":"1em",e.style.lineHeight="120%",void 0!==c.color&&(e.style.color=c.color),b=0;b<f.length;b+=1)i[b]=f[b],"false"!==c.cleanTags&&(i[b]=k(i[b],"b","bold"),i[b]=k(i[b],"i","italic"),i[b]=k(i[b],"em","emphasis"),i[b]=k(i[b],"color","color",!0),i[b]=k(i[b],"size","size",!0),i[b]=k(i[b],"font","font",!0),i[b]=l(i[b])),i[b]=i[b].replace(/\[bold\](.*?)\[\/bold\]/gi,"<b>$1</b>"),i[b]=i[b].replace(/\[italic\](.*?)\[\/italic\]/gi,"<i>$1</i>"),i[b]=i[b].replace(/\[emphasis\](.*?)\[\/emphasis\]/gi,"<em>$1</em>"),i[b]=i[b].replace(/\[color=(.*?)\](.*)\[\/color\]/gi,'<span style="color:$1">$2</span>'),i[b]=i[b].replace(/\[size=(.*?)\](.*?)\[\/size\]/gi,'<span style="font-size:$1em">$2</span>'),i[b]=i[b].replace(/\[font=(.*?)\](.*?)\[\/font\]/gi,'<span style="font-family:$1">$2</span>'),1===f.length?e.innerHTML=i[b]:(j[b]=a.document.createElement("p"),null!==d.paragraphSpacing&&(j[b].style.marginBottom=-1!==d.paragraphSpacing.toString().toUpperCase().indexOf("PX")?d.paragraphSpacing:d.paragraphSpacing+"%"),e.appendChild(j[b]),j[b].innerHTML=i[b]);d.addEventListener("PRESS",d.press)}};return f="string"==typeof c.text?[c.text]:c.text,e=1===f.length?a.document.createElement("p"):a.document.createElement("div"),d=b.KIDS.storybook.view(b,e),h&&h.appendChild(e),d.x=c&&void 0!==c.x?c.x:0,d.y=c&&void 0!==c.y?c.y:0,d.width=c&&void 0!==c.width?c.width:100,d.horizontalAlign=c&&void 0!==c.horizontalAlign?c.horizontalAlign.toUpperCase():"LEFT",d.verticalAlign=c&&void 0!==c.verticalAlign?c.verticalAlign.toUpperCase():"TOP",d.parentWidth=c.parentWidth,d.parentHeight=c.parentHeight,d.paragraphSpacing=void 0!==c.paragraphSpacing?c.paragraphSpacing:null,d.update=function(){},d.render=function(){d.dirty&&(d.dirty=!1)},d.press=function(a){console.log("PRESS")},m(),d},PBS.KIDS.storybook.view=function(a,b){"use strict";var c=a.KIDS.storybook.eventDispatcher(),d=a.KIDS.storybook;return c.parentWidth=0,c.parentHeight=0,c.x=0,c.y=0,c.width=0,c.height=0,c.horizontalAlign="LEFT",c.verticalAlign="TOP",c.dirty=!1,c.getElement=function(){return b},c.initView=function(){"RIGHT"===c.horizontalAlign?d.isInPixelUnits(c.x)?c.parentWidth?b.style.right=d.getNumberFromString(c.x)/c.parentWidth*100+"%":b.style.right=c.x:b.style.right=d.getNumberFromString(c.x)+"%":d.isInPixelUnits(c.x)?c.parentWidth?b.style.left=d.getNumberFromString(c.x)/c.parentWidth*100+"%":b.style.left=c.x:b.style.left=d.getNumberFromString(c.x)+"%","BOTTOM"===c.verticalAlign?d.isInPixelUnits(c.y)?c.parentHeight?b.style.bottom=d.getNumberFromString(c.y)/c.parentHeight*100+"%":b.style.bottom=c.y:b.style.bottom=d.getNumberFromString(c.y)+"%":d.isInPixelUnits(c.y)?c.parentHeight?b.style.top=d.getNumberFromString(c.y)/c.parentHeight*100+"%":b.style.top=c.y:b.style.top=d.getNumberFromString(c.y)+"%",c.width&&(d.isInPixelUnits(c.width)?c.parentWidth?b.style.width=d.getNumberFromString(c.width)/c.parentWidth*100+"%":b.style.width=c.width:b.style.width=d.getNumberFromString(c.width)+"%"),c.height&&(d.isInPixelUnits(c.height)?c.parentHeight?b.style.height=d.getNumberFromString(c.height)/c.parentHeight*100+"%":b.style.height=c.height:b.style.height=d.getNumberFromString(c.height)+"%")},c.destroy=function(){b=null,c.removeAllEventListeners(),c=null},c},PBS.KIDS.storybook.sprite=function(a,b,c){"use strict";var d,e,f,g,h,i=c&&void 0!==c.resource?c.resource:void 0,j=!1,k={},l=0,m=0,n=0,o=c.frameDelay||1,p=c.loop,q=c&&c.parentElement,r=!1,s=1,t=1,u=c.color,v=c.numFrames,w=function(){j||(j=!0,d.initView(),i&&i.image?(d.width=i.image.width,d.height=i.image.height):(d.width=100,d.height=100),g=v?d.width/v:d.width,h=d.height,e.width=g,e.height=h,c.width?-1!==c.width.toString().indexOf("px")?e.style.width=c.width:e.style.width=c.width+"%":d.parentWidth&&(s=e.width/d.parentWidth,e.style.width=100*s+"%"),c.height?-1!==c.height.toString().indexOf("px")?e.style.height=c.height:e.style.height=c.height+"%":d.parentHeight&&(t=e.height/d.parentHeight,e.style.height=100*t+"%"),d.addEventListener("PRESS",d.press),d.autoStart===!1&&(r=!0),d.dirty=!0)},x=function(){w()},y=function(b,d,e){var f;return f=c.easing&&"EASEIN"===c.easing.toUpperCase()?e*(1-a.Math.cos(b/d*a.Math.PI/2)):c.easing&&"EASEOUT"===c.easing.toUpperCase()?e*a.Math.sin(b/d*a.Math.PI/2):e*b/d,a.Math.floor(f)};return k.width="99px",k.height="99px",k.className="pbsCanvas pbsSprite",c&&c.className&&(k.className+=" "+c.className),f=b.KIDS.storybook.createCanvas(q,k),d=b.KIDS.storybook.view(b,f.canvas),e=d.getElement(),d.x=c&&void 0!==c.x?c.x:0,d.y=c&&void 0!==c.y?c.y:0,d.width=c&&void 0!==c.width?c.width:0,d.height=c&&void 0!==c.height?c.height:0,d.parentWidth=c.parentWidth,d.parentHeight=c.parentHeight,d.horizontalAlign=c&&void 0!==c.horizontalAlign?c.horizontalAlign.toUpperCase():"LEFT",d.verticalAlign=c&&void 0!==c.verticalAlign?c.verticalAlign.toUpperCase():"TOP",d.visible=!0,d.alpha=0,d.destroyed=!1,d.url=c&&c.url,d.autoStart=c&&void 0!==c.autoStart?c.autoStart:!0,d.autoReset=c&&void 0!==c.autoReset?c.autoReset:!1,d.update=function(){v&&!r&&(n+1>=v*o?p?(m=0,n=0):d.autoReset&&(m=0,n=0,d.stop()):(n+=1,m=y(n,v*o,v)),l!==m&&(d.dirty=!0,l=m))},d.render=function(){var b;j&&d.dirty&&(d.visible?(b=f.globalAlpha,f.globalAlpha=d.alpha,u&&(f.fillStyle=u,f.fillRect(0,0,g,h)),i&&i.image&&(v?(f.canvas.width=f.canvas.width,f.drawImage(i.image,a.Math.floor(m*g),0,g,h,0,0,g,h)):f.drawImage(i.image,0,0,g,h),f.globalAlpha=b)):f.clearRect(0,0,g,h),d.dirty=!1)},d.getElement=function(){return e},d.play=function(){d.reset(),r=!1},d.isAnimation=function(){return v>1},d.resume=function(){r=!1,d.dirty=!0},d.stop=function(){r=!0},d.reset=function(){0!==m&&(m=0,n=0,d.dirty=!0,d.stop())},d.press=function(){c.playOnPress?d.play():c.stopOnPress?d.stop():c.toggleOnPress&&(r?d.resume():d.stop())},i&&i.image?i.image.addEventListener("load",x):x(),d},PBS.KIDS.storybook.cycler=function(a,b,c){"use strict";var d=b.KIDS.storybook.eventDispatcher(),e=!1,f=[],g=!1,h=0,i=function(){var h,i,l;if(!e)if(e=!0,c&&c.content){var m=function(a){d.dispatchEvent("PRESS",{x:a.x,y:a.y}),(g||!f[0].isAnimation()||d.autoStart)&&d.cycle(),k(),j(),g=!0};for(h=0;h<c.content.length;h+=1)l=c.content[h],l.parentElement=c.parentElement,l.parentWidth=c.parentWidth,l.parentHeight=c.parentHeight,c.className&&(l.className=c.className+"Sprite"+(h+1)),i=b.KIDS.storybook.sprite(a,b,l),
i=b.KIDS.storybook.makeInteractionObject(a,b,i),i.addEventListener("PRESS",m),f.push(i)}else b.KIDS.storybook.error("Cycler missing content array.")},j=function(){var a;for(a=0;a<f.length;a+=1)f[a].visible=a===h,f[a].dirty=!0,f[a].render()},k=function(){var a;for(a=0;a<f.length;a+=1)a===h?f[a].play():f[a].reset()};return d.x=c&&void 0!==c.x?c.x:0,d.y=c&&void 0!==c.y?c.y:0,d.width=c&&void 0!==c.width?c.width:0,d.height=c&&void 0!==c.height?c.height:0,d.autoStart=c&&void 0!==c.autoStart?c.autoStart:!0,d.autoReset=c&&void 0!==c.autoReset?c.autoReset:!1,d.cycle=function(){h<f.length-1?h+=1:h=0,k(),j()},d.play=function(){f[h].play()},d.resume=function(){f[h].resume()},d.stop=function(){f[h].stop()},d.reset=function(){g=!1,h=0,f[h].reset(),j()},d.update=function(){f[h].update()},d.render=function(){f[h].render()},d.destroy=function(){var a;for(a=0;a<f.length;a+=1)f[a].destroy();f=null,d=null},i(),d},PBS.KIDS.storybook.drawingPad=function(a,b,c){"use strict";var d,e,f,g=b.KIDS.storybook,h=!1,i=c&&c.parentElement,j=[],k=[],l=[],m=function(){d.dirty=!0},n=function(a){f.setTool("MARKER"),f.setColor(a)},o=function(){f.clear()},p=function(){f.setTool("ERASER")},q=function(){var q,r,s,t,u;if(!h){h=!0,d.initView(),e.className="pbsDrawingPad",c.className&&(e.className+=" "+c.className),r=g.isInPixelUnits(d.width)?g.getNumberFromString(d.width):g.isInPercentageUnits(d.width)?g.getNumberFromString(d.width)*d.parentWidth/100:d.width*d.parentWidth/100,s=g.isInPixelUnits(d.height)?g.getNumberFromString(d.height):g.isInPercentageUnits(d.height)?g.getNumberFromString(d.height)*d.parentHeight/100:d.height*d.parentHeight/100,f=WM.drawingCanvas(e,{width:r,height:s,defaultColor:c.defaultColor,radius:c.radius,overlayUrl:c.overlayUrl,textureUrl:c.textureUrl});for(t in c)if("colorButtons"===t)for(q=0;q<c.colorButtons.length;q+=1)for(u in c.colorButtons[q])"url"===u&&(0===q&&n(c.colorButtons[q].paintColor),c.colorButtons[q].parentElement=i,c.colorButtons[q].parentWidth=d.parentWidth,c.colorButtons[q].parentHeight=d.parentHeight,c.className&&(c.colorButtons[q].className=c.className+"ColorButton"+(q+1)),c.colorButtons[q].resource.image.addEventListener("load",m),j.push(g.sprite(a,b,c.colorButtons[q])),j[j.length-1]=g.makeInteractionObject(a,b,j[j.length-1]),j[j.length-1].addEventListener("PRESS",n.bind(null,c.colorButtons[q].paintColor)));else if("clearButtons"===t)for(q=0;q<c.clearButtons.length;q+=1)for(u in c.clearButtons[q])"url"===u&&(c.clearButtons[q].parentElement=i,c.clearButtons[q].parentWidth=d.parentWidth,c.clearButtons[q].parentHeight=d.parentHeight,c.className&&(c.clearButtons[q].className=c.className+"ClearButton"+(q+1)),c.clearButtons[q].resource.image.addEventListener("load",m),k.push(g.sprite(a,b,c.clearButtons[q])),k[k.length-1]=g.makeInteractionObject(a,b,k[k.length-1]),k[k.length-1].addEventListener("PRESS",o));else if("eraserButtons"===t)for(q=0;q<c.eraserButtons.length;q+=1)for(u in c.eraserButtons[q])"url"===u&&(c.eraserButtons[q].parentElement=i,c.eraserButtons[q].parentWidth=d.parentWidth,c.eraserButtons[q].parentHeight=d.parentHeight,c.className&&(c.eraserButtons[q].className=c.className+"EraserButton"+(q+1)),c.eraserButtons[q].resource.image.addEventListener("load",m),l.push(g.sprite(a,b,c.eraserButtons[q])),l[l.length-1]=g.makeInteractionObject(a,b,l[l.length-1]),l[l.length-1].addEventListener("PRESS",p))}};return e=a.document.createElement("div"),d=b.KIDS.storybook.view(b,e),i&&i.appendChild(e),d.x=c&&void 0!==c.x?c.x:0,d.y=c&&void 0!==c.y?c.y:0,d.width=c&&void 0!==c.width?c.width:100-d.x+"%",d.height=c&&void 0!==c.height?c.height:100-d.y+"%",d.dirty=!0,d.parentWidth=c&&void 0!==c.parentWidth?c.parentWidth:100,d.parentHeight=c&&void 0!==c.parentHeight?c.parentHeight:100,d.update=function(){},d.render=function(){var a;if(d.dirty){for(d.dirty=!1,a=0;a<j.length;a+=1)j[a].render();for(a=0;a<l.length;a+=1)l[a].render();for(a=0;a<k.length;a+=1)k[a].render()}},q(),d},PBS.KIDS.storybook.audioPlayer=function(a,b,c,d){"use strict";var e,f,g,h=b.KIDS.storybook.eventDispatcher(),i=!1,j=!1,k=!1,l=0,m=null,n=function(){},o=function(){},p=function(){k||(k=!0,h.dispatchEvent("LOAD_STARTED"))},q=function(){k||(k=!0,h.dispatchEvent("LOAD_STARTED"))},r=function(){},s=function(){},t=function(){},u=function(){},v=function(){},w=function(a){b.KIDS.storybook.debug("audioPlayer.onError: "+a.message)},x=function(){if(!i){if(i=!0,e=a.document.createElement("audio"),e.addEventListener("pause",o),e.addEventListener("play",n),e.addEventListener("canplay",p),e.addEventListener("canplaythrough",q),e.addEventListener("loadeddata",r),e.addEventListener("loadedmetadata",s),e.addEventListener("progress",t),e.addEventListener("ended",u),e.addEventListener("stalled",v),e.addEventListener("error",w),e.canPlayType("audio/mpeg"))c+=".mp3";else{if(!e.canPlayType("audio/ogg"))return!1;c+=".ogg"}return!0}},y=function(){f=a.setInterval(function(){var b,c;e.buffered.length&&(b=e.buffered.end(e.buffered.length-1),c=b/e.duration*100,b&&!isNaN(c)&&l!==c&&(l=c,h.dispatchEvent("LOAD_PERCENTAGE_CHANGE")),a.Math.abs(b-e.duration)<.1&&(a.clearInterval(f),h.dispatchEvent("LOAD_COMPLETE")))},1e3),e.src=c,e.play(),e.pause()},z=function(){a.clearInterval(g),g=null,m=null,e.pause()},A=function(){return m?void(e.currentTime>=m.endTime&&(m.loop===!0?(b.KIDS.storybook.log("Loop Sound"),e.currentTime=m.startTime):z(),h.dispatchEvent("PLAY_COMPLETE"))):void a.clearInterval(g)};return h.autoStart=d&&void 0!==d.autoStart?d.autoStart:!0,h.autoReset=d&&void 0!==d.autoReset?d.autoReset:!1,h.play=function(c){return c?void 0===c.startTime||c.startTime<0?void b.KIDS.storybook.warning("Trying to play sound with invalid sound property. Start time invalid."):void 0===c.endTime||c.endTime<0?void b.KIDS.storybook.warning("Trying to play sound with invalid sound property. End time invalid."):c.startTime>=c.endTime?void b.KIDS.storybook.warning("Trying to play sound with invalid sound property. Duration is zero or negative."):void(m&&m.persist||(m=c,e.currentTime=m.startTime,b.KIDS.storybook.log("Play Sound: "+m.startTime+" -> "+m.endTime+" (loop: "+m.loop+", audioElement.currentTime: "+e.currentTime),e.play(),g||(g=a.setInterval(A,100)))):void b.KIDS.storybook.warning("Trying to play invalid sound.")},h.stop=function(){z()},h.load=function(){j||(j=!0,y())},h.destroy=function(){e=null},h.getElement=function(){return e},h.getLoadPercentage=function(){return l},h.getSound=function(){return m},x()?h:!1},PBS.KIDS.storybook.sound=function(a,b,c){"use strict";var d={};return d.loop=c&&c.loop?c.loop:!1,d.name=c&&c.name?c.name:null,d.persist=c&&c.persist?c.persist:!1,d.startTime=a,d.endTime=b,d},PBS.KIDS.storybook.makeAudible=function(a,b,c,d,e){"use strict";var f=(b.KIDS.storybook,function(a){c.play(e)});return d.silent=function(){c.stop()},d.addEventListener("PRESS",f),d};}();